!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.CardValidation=t.CardValidation||{})}(this,function(t){"use strict";var e=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},i=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),n=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},r=function(){function t(){e(this,t)}return i(t,null,[{key:"validateLuhn",value:function(t){for(var e=[[0,1,2,3,4,5,6,7,8,9],[0,2,4,6,8,1,3,5,7,9]],i=t.length,n=0,o=0;i--;)o+=e[n][parseInt(t.charAt(i),10)],n^=1;return o%10===0&&o>0}},{key:"isNumberBeginMatch",value:function(t,e){return e.some(function(e){var i=e.substring(0,t.length);return i===t.substring(0,i.length)})}}]),t}(),u=function(){function t(i){e(this,t),this.cardTypes=i}return i(t,[{key:"find",value:function(t,e,i){var n=this.cardTypes.filter(function(e){return r.isNumberBeginMatch(t,e.getStartDigits())});return n.length?n.map(function(n,o,r){return new r[o](t,e,i)}):[]}}]),t}(),a=function(t){function i(t){e(this,i);var n=o(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t));return n.message=t,n.name="MissingDataError",n}return n(i,t),i}(Error),s=function(){function t(i,n,o){e(this,t),this.setNumber(i),n&&this.setExpire(n),o&&this.setCode(o)}return i(t,[{key:"getName",value:function(){return this.name}},{key:"getNumber",value:function(){return this.number}},{key:"setNumber",value:function(t){return this.number=t,this}},{key:"getExpire",value:function(){return this.expire}},{key:"setExpire",value:function(e){return this.expire=t.getCleanedDate(e),this}},{key:"getCode",value:function(){return this.code}},{key:"setCode",value:function(t){return this.code=t,this.code}},{key:"getCodeLocation",value:function(){return this.codeLocation}},{key:"isExpired",value:function(){if(!this.getExpire())throw new a("Expire date information is missing.");return t.getCleanedDate(new Date)>this.getExpire()}},{key:"isLuhnValid",value:function(){return r.validateLuhn(this.getNumber())}},{key:"isCardTypeValid",value:function(){return r.isNumberBeginMatch(this.getNumber(),this.startDigits)}},{key:"isNumberOfDigitsValid",value:function(){var t=this;return this.allowedDigits.some(function(e){return e===t.getNumber().length})}},{key:"isNumberOfCodeDigitsValid",value:function(){if(!this.getCode())throw new a("Card card code information is missing.");return this.allowedCodeDigits===this.getCode().length}},{key:"isValid",value:function(){return this.isLuhnValid()&&this.isNumberOfDigitsValid()&&this.isNumberOfCodeDigitsValid()&&this.isCardTypeValid()&&!this.isExpired()}}],[{key:"getCleanedDate",value:function(t){return new Date(t.getFullYear(),t.getMonth())}}]),t}(),l=function(t){function r(t,i,n){e(this,r);var u=o(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t,i,n));return u.name="Master Card",u.allowedDigits=r.getAllowedDigits(),u.allowedCodeDigits=r.getAllowedCodeDigits(),u.codeLocation=r.getCodeLocation(),u.startDigits=r.getStartDigits(),u}return n(r,t),i(r,null,[{key:"getStartDigits",value:function(){return["51","52","53","54","55","23","24","25","26","27","222","223","224","225","226","227","228","229"]}},{key:"getCodeLocation",value:function(){return"back"}},{key:"getAllowedCodeDigits",value:function(){return 3}},{key:"getAllowedDigits",value:function(){return[16]}}]),r}(s),c=function(t){function r(t,i,n){e(this,r);var u=o(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t,i,n));return u.name="Visa",u.allowedDigits=r.getAllowedDigits(),u.allowedCodeDigits=r.getAllowedCodeDigits(),u.codeLocation=r.getCodeLocation(),u.startDigits=r.getStartDigits(),u}return n(r,t),i(r,null,[{key:"getStartDigits",value:function(){return["4"]}},{key:"getCodeLocation",value:function(){return"back"}},{key:"getAllowedCodeDigits",value:function(){return 3}},{key:"getAllowedDigits",value:function(){return[13,16,19]}}]),r}(s),g=function(t){function r(t,i,n){e(this,r);var u=o(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t,i,n));return u.name="American Express",u.allowedDigits=r.getAllowedDigits(),u.allowedCodeDigits=r.getAllowedCodeDigits(),u.codeLocation=r.getCodeLocation(),u.startDigits=r.getStartDigits(),u}return n(r,t),i(r,null,[{key:"getStartDigits",value:function(){return["34","37"]}},{key:"getCodeLocation",value:function(){return"front"}},{key:"getAllowedCodeDigits",value:function(){return 4}},{key:"getAllowedDigits",value:function(){return[15]}}]),r}(s),d=function(t){function r(t,i,n){e(this,r);var u=o(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t,i,n));return u.name="Dinners Club",u.allowedDigits=r.getAllowedDigits(),u.allowedCodeDigits=r.getAllowedCodeDigits(),u.codeLocation=r.getCodeLocation(),u.startDigits=r.getStartDigits(),u}return n(r,t),i(r,null,[{key:"getStartDigits",value:function(){return["300","301","302","303","304","305","309","36","38","39"]}},{key:"getCodeLocation",value:function(){return"back"}},{key:"getAllowedCodeDigits",value:function(){return 3}},{key:"getAllowedDigits",value:function(){return[14]}}]),r}(s),f=function(t){function r(t,i,n){e(this,r);var u=o(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t,i,n));return u.name="JBC",u.allowedDigits=r.getAllowedDigits(),u.allowedCodeDigits=r.getAllowedCodeDigits(),u.codeLocation=r.getCodeLocation(),u.startDigits=r.getStartDigits(),u}return n(r,t),i(r,null,[{key:"getStartDigits",value:function(){return["35"]}},{key:"getCodeLocation",value:function(){return"back"}},{key:"getAllowedCodeDigits",value:function(){return 3}},{key:"getAllowedDigits",value:function(){return[16,17,18,19]}}]),r}(s),h=function(t){function r(t,i,n){e(this,r);var u=o(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t,i,n));return u.name="Maestro Card",u.allowedDigits=r.getAllowedDigits(),u.allowedCodeDigits=r.getAllowedCodeDigits(),u.codeLocation=r.getCodeLocation(),u.startDigits=r.getStartDigits(),u}return n(r,t),i(r,null,[{key:"getStartDigits",value:function(){return["50","56","57","58","59","61","62","63","64","65","66","67","68","69"]}},{key:"getCodeLocation",value:function(){return"back"}},{key:"getAllowedCodeDigits",value:function(){return 3}},{key:"getAllowedDigits",value:function(){return[12,13,14,15,16,17,18,19]}}]),r}(s),y={MasterCard:l,Visa:c,AmericanExpress:g,DinnersClub:d,JCB:f,MaestroCard:h};t.CreditCardFactory=u,t.CreditCard=s,t.cards=y,Object.defineProperty(t,"__esModule",{value:!0})});
